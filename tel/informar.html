 <!DOCTYPE html>
<html>
<head>
    <title>Territorio para predicación telefónica</title>
    <meta name="robots" content="noindex" />
    <meta name="robots" content="nofollow" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/jsonata@1.6.4/jsonata.min.js"></script>    
<!-- Bootstrap Date-Picker Plugin -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>
    <link href="/app/css/bootstrap.min.css" rel="stylesheet">
  <script>
    var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
};
    var telefono = getUrlParameter('telefono');
    var registrotel;
    console.log(telefono);
         $(function() {
        $.getJSON('https://sheets.googleapis.com/v4/spreadsheets/1VGOPLJ19ms7Xi1NyLFE83cjAkq3OrffrwRjjxgcgSQ4/values/telefonos?alt=json&key=AIzaSyCz4sutc6Z6Hh5FtBTB53I8-ljkj6XWpPc')
            .done(function(jsonurl) {
          var data = jsonata('$.values.({"Telefono":$[0], "Direccion":$[1], "Localidad":$[2], "Respuesta":$[3], "Publicador":$[4], "Fecha":$[5], "Turno":$[6], "Observaciones":$[7]})').evaluate(jsonurl);
                registrotel = jsonata('$[Telefono="' + telefono + '"]').evaluate(data);
               console.log(registrotel);
            });
            

    });
  </script>
  
  </head>
  <body >
<form class="form-horizontal">
  <div class="form-group">
    <label for="telefono" class="control-label col-xs-4">Teléfono</label> 
    <div class="col-xs-8">
      <input id="telefono" name="telefono" type="text" class="form-control">
    </div>
  </div>
  <div class="form-group">
    <label for="direccion" class="control-label col-xs-4">Dirección</label> 
    <div class="col-xs-8">
      <input id="direccion" name="direccion" type="text" class="form-control">
    </div>
  </div>
  <div class="form-group">
    <label for="localidad" class="control-label col-xs-4">Localidad</label> 
    <div class="col-xs-8">
      <input id="localidad" name="localidad" type="text" class="form-control">
    </div>
  </div>
  <div class="form-group">
    <label for="estado" class="control-label col-xs-4">Respuesta</label> 
    <div class="col-xs-8">
      <select id="estado" name="estado" class="select form-control" required="required">
        <option value="rabbit">Rabbit</option>
        <option value="duck">Duck</option>
        <option value="fish">Fish</option>
      </select>
    </div>
  </div>
  <div class="form-group">
    <label for="fecha" class="control-label col-xs-4">Fecha</label> 
    <div class="col-xs-8">
      <div class="input-group date">
  <input id="fecha" name="fecha" type="text" class="form-control"><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
</div>
     
    </div>
  </div>
  <div class="form-group">
    <label for="select" class="control-label col-xs-4">Turno</label> 
    <div class="col-xs-8">
      <select id="select" name="select" class="select form-control" required="required">
        <option value="Mañana">Mañana</option>
        <option value="Tarde">Tarde</option>
      </select>
    </div>
  </div>
  <div class="form-group">
    <label for="publicador" class="control-label col-xs-4">Publicador</label> 
    <div class="col-xs-8">
      <input id="publicador" name="publicador" type="text" class="form-control" aria-describedby="publicadorHelpBlock"> 
      <span id="publicadorHelpBlock" class="help-block">Sólo para revisitas</span>
    </div>
  </div>
  <div class="form-group">
    <label for="responsable" class="control-label col-xs-4">Responsable</label> 
    <div class="col-xs-8">
      <select id="responsable" name="responsable" class="select form-control" required="required">
        <option value="rabbit">Rabbit</option>
        <option value="duck">Duck</option>
        <option value="fish">Fish</option>
      </select>
    </div>
  </div>
  <div class="form-group">
    <label for="observaciones" class="control-label col-xs-4">Observaciones</label> 
    <div class="col-xs-8">
      <textarea id="observaciones" name="observaciones" cols="40" rows="1" class="form-control" aria-describedby="observacionesHelpBlock"></textarea> 
      <span id="observacionesHelpBlock" class="help-block">Opcional. Escribí sólo lo necesario.</span>
    </div>
  </div> 
  <div class="form-group row">
    <div class="col-xs-offset-4 col-xs-8">
      <button name="submit" type="submit" class="btn btn-primary">Submit</button>
    </div>
  </div>
</form>
    
<form name="submit-to-google-sheet">

  <input name="Telefono" type="hidden" required>
  <input name="Direccion" type="text" required>
  <input name="Localidad" type="text" required>
  <input name="Estado" type="text" required>
  <input name="Publicador" type="text" required>
  <input name="Fecha" type="text" required>
    <input name="Turno" type="text" required>
  <input name="Observaciones" type="text" required>
  <input name="Responsable" type="text" required>
  <button type="submit">Send</button>
</form>
<script src="https://wzrd.in/standalone/formdata-polyfill"></script>
<script src="https://wzrd.in/standalone/promise-polyfill@latest"></script>
<script src="https://wzrd.in/standalone/whatwg-fetch@latest"></script>

<script>
      $(document).ready(function(){
      var date_input=$('input[name="fecha"]'); //our date input has the name "date"
      var container=$('.bootstrap-iso form').length>0 ? $('.bootstrap-iso form').parent() : "body";
      var options={
    format: "dd/mm/yyyy",
    todayBtn: "linked",
    language: "es",
    daysOfWeekHighlighted: "0,6",
    todayHighlight: true
      };
      date_input.datepicker(options);
    });

  
  
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzivt4eVHnlJKOwMIHFq6n200v8eMOkx8qNJOgFf08R-ncjqa_r/exec'
  const form = document.forms['submit-to-google-sheet']

  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => console.log('Success!', response))
      .catch(error => console.error('Error!', error.message))
  })
</script>
  </body>
    </html>
