 <!DOCTYPE html>
<html>
<head>
    <title>Territorio para predicación telefónica</title>
    <meta name="robots" content="noindex" />
    <meta name="robots" content="nofollow" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon.ico">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/jsonata@1.6.4/jsonata.min.js"></script>    

    <link href="/app/css/bootstrap.min.css" rel="stylesheet">
  <script>
    var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
};
    var telefono = getUrlParameter('telefono');
    var registrotel;
    console.log(telefono);
         $(function() {
        $.getJSON('https://sheets.googleapis.com/v4/spreadsheets/1VGOPLJ19ms7Xi1NyLFE83cjAkq3OrffrwRjjxgcgSQ4/values/telefonos?alt=json&key=AIzaSyCz4sutc6Z6Hh5FtBTB53I8-ljkj6XWpPc')
            .done(function(jsonurl) {
          var data = jsonata('$.values.({"Telefono":$[0], "Direccion":$[1], "Localidad":$[2], "Respuesta":$[3], "Publicador":$[4], "Fecha":$[5], "Turno":$[6], "Observaciones":$[7]})').evaluate(jsonurl);
                registrotel = jsonata('$[Telefono="' + telefono + '"]').evaluate(data);
               console.log(registrotel);
            });
            

    });
  </script>
  
  </head>
  <body>
<form name="submit-to-google-sheet">
  <div class="form-group">
  <label>Teléfono</label>
    <p class="form-control-static">123456</p>
  <input name="Telefono" type="hidden" required>
  </div>
  <input name="Direccion" type="text" required>
  <input name="Localidad" type="text" required>
    <div class="form-group">
    <label for="respuesta">Respuesta</label>
  <select class="form-control">
  <option>1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
  <option>5</option>
</select>
  <input name="Estado" type="text" required>
  <input name="Publicador" type="text" required>
  <input name="Fecha" type="text" required>
    <input name="Turno" type="text" required>
  <input name="Observaciones" type="text" required>
  <input name="Responsable" type="text" required>
  <button type="submit">Send</button>
</form>
<script src="https://wzrd.in/standalone/formdata-polyfill"></script>
<script src="https://wzrd.in/standalone/promise-polyfill@latest"></script>
<script src="https://wzrd.in/standalone/whatwg-fetch@latest"></script>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzivt4eVHnlJKOwMIHFq6n200v8eMOkx8qNJOgFf08R-ncjqa_r/exec'
  const form = document.forms['submit-to-google-sheet']

  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => console.log('Success!', response))
      .catch(error => console.error('Error!', error.message))
  })
</script>
  </body>
    </html>
